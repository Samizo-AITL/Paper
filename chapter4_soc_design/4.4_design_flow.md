# 4.4：設計フロー（RTL → 論理合成 → 物理設計 → 検証 → マスク作成）

SoC設計は、製品仕様をもとにして回路を記述するRTL設計からスタートし、最終的にはGDSII形式のマスクデータとしてファウンドリに引き渡されます。この一連の設計フローは、各ステップが密接に関連しており、上流の判断が下流工程に直接影響します。

本節では、設計の実務的な流れを、RTLからマスク作成まで順を追って説明します。

---

## RTL設計（Register Transfer Level）

設計の第一段階では、回路の機能を記述するために、HDL（Hardware Description Language）を用いてRTLを設計します。代表的な言語には Verilog や VHDL があり、状態遷移、データ処理、制御信号などをクロック単位で記述します。

この段階では、主に以下を行います：

- 状態機械（FSM）やカウンタ、データパスなどの論理記述
- テストベンチによる機能検証（シミュレーション）
- 機能要件とクロック構造の整理

RTL設計の品質がその後のすべての工程に影響するため、テストベンチによる入念な検証が欠かせません。

---

## 論理合成（Logic Synthesis）

次に、RTLで記述された設計は論理合成ツールを用いて、標準セルの組み合わせからなる論理回路（ゲートレベルネットリスト）に変換されます。ここでは、設計者が設定したタイミング制約や消費電力目標に基づいて、最適な論理回路構造が自動的に生成されます。

主な成果物は：

- ネットリスト（回路接続情報）
- タイミング情報（SDFなど）
- 面積・消費電力のレポート

この段階で、合成された回路が目標クロックに対して成立しているかを確認します。

---

## 物理設計（Physical Design）

論理合成されたネットリストをもとに、実際にチップ上に回路を配置し、配線する工程が物理設計です。標準セルの配置、クロックツリー合成（CTS）、ルーティング（配線）、パッドの配置といった作業が含まれます。

この段階で初めて、電気的・物理的な制約（配線遅延、干渉、面積超過など）に直面します。物理設計の成否は、チップの性能や歩留まりに直結するため、詳細な調整が必要です。

---

## 設計検証（Verification）

物理設計が完了したら、設計が正しいかを確認するための検証工程に入ります。主に以下の検証が行われます：

- **DRC（Design Rule Check）**：物理設計がプロセスのルールに違反していないか確認
- **LVS（Layout vs. Schematic）**：回路図とレイアウトが一致しているか確認
- **STA（Static Timing Analysis）**：クロックに基づいた遅延・セットアップ違反の有無を確認

これらの検証を通じて、設計の完全性と製造可能性を保証します。

---

## マスクデータ作成（GDSII Export）

設計検証が完了したら、チップ製造のための最終データとしてGDSII形式のマスクデータを生成します。これは、フォトマスクの原版を作るための情報であり、ファウンドリに引き渡されます。

GDSデータは設計のすべてを表しており、ここまで到達すれば、設計として一つの完結を迎えます。

---

## おわりに

このように、SoCの設計フローは、RTL設計から論理合成、物理設計、検証、そしてGDSIIマスクデータの作成へと一貫した工程で構成されています。各ステップでの品質と検証が、最終的な製品の性能と信頼性を左右します。

教育の現場では、この一連の流れを演習的に体験することで、半導体設計の実際に近い感覚を得ることができます。

次章では、この設計成果がどのようにテスト・パッケージ化され、製品として世に出るのかを学びます。
