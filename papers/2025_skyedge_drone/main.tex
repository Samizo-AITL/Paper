\documentclass[conference]{IEEEtran}

% ---------- Packages ----------
\usepackage{amsmath, amssymb, graphicx, cite, hyperref}
\usepackage{tikz}
\usetikzlibrary{calc,arrows.meta,positioning,fit,shapes.geometric}
\usepackage{pgfplots}
\pgfplotsset{compat=1.18}
\usepackage{siunitx}

% ---------- Title ----------
\title{SkyEdge: Secure High-Altitude Drone Platform Integrating $H_\infty$ Control, Domestic Devices, and Advanced Mechanical Design}

% ---------- Author ----------
\author{
\IEEEauthorblockN{Shinichi Samizo}
\IEEEauthorblockA{Independent Semiconductor Researcher \\
Project Design Hub, Samizo-AITL \\
\textit{Email:} \href{mailto:shin3t72@gmail.com}{shin3t72@gmail.com} \\
\textit{GitHub:} \href{https://github.com/Samizo-AITL}{Samizo-AITL}}
}

\begin{document}
\maketitle

% ---------- Abstract ----------
\begin{abstract}
This paper presents the foundational design of \emph{SkyEdge}, 
a secure high-altitude unmanned aerial vehicle (UAV) platform that 
integrates $H_\infty$ control, domestic devices, and a variable-pitch 
mechanical structure. The proposed framework provides robust disturbance 
rejection, secure hardware implementation, and reliable flight capability 
up to 10{,}000 m altitude. We describe the control architecture, device 
integration, and mechanical design, and we outline evaluation plans 
toward a proof-of-concept prototype.
\end{abstract}

% ---------- Keywords ----------
\begin{IEEEkeywords}
UAV, robust control, $H_\infty$, variable-pitch rotor, secure systems, high-altitude flight
\end{IEEEkeywords}

% =============================================================
\section{Introduction}
Unmanned aerial vehicles (UAVs) are increasingly important for defense surveillance, disaster response, and environmental monitoring. Existing commercial drones typically operate below 3{,}000 m due to aerodynamic, thermal, and electronic constraints. At such altitudes, control is relatively stable, but performance rapidly degrades in thinner air above 5{,}000 m.  

A further concern is security. Many high-end commercial UAVs integrate foreign-manufactured devices, including SoCs and communication modules, that raise supply-chain trust issues. For defense and critical infrastructure, reliance on foreign hardware introduces unacceptable vulnerabilities.  

The objective of this research is to establish a secure, domestically sourced UAV platform capable of reliable operations up to 10 km. The SkyEdge framework integrates three pillars:  
(1) a robust $H_\infty$ controller with disturbance rejection against gusts exceeding 25 m/s,  
(2) hardware integration based on domestic SoCs and secure TPM/PQC devices, and  
(3) a mechanical design featuring a variable-pitch rotor capable of maintaining thrust margin across altitudes.  

% =============================================================
\section{Related Work}
Conventional UAV control relies on PID loops due to their simplicity and ease of tuning. However, PID controllers exhibit overshoot and poor disturbance rejection under severe gusts. Adaptive control techniques and sliding mode controllers have been introduced, but they suffer from computational complexity and chattering phenomena.  

In contrast, $H_\infty$ control provides a systematic framework to attenuate worst-case disturbances \cite{zhou1996robust}. Several studies have applied $H_\infty$ to aerial vehicles, demonstrating robustness against turbulence, yet rarely extending to high-altitude environments.  

High-altitude UAV projects such as NASA Helios \cite{nasahelios} and JAXA HAPS \cite{jaxaHAPS} validated long-endurance concepts. However, these relied on specialized aerostructures and foreign components, leaving a gap for modular platforms emphasizing domestic device integration and security.  

On the hardware side, cryptographic modules for UAVs are still rarely studied. Most commercial UAVs implement proprietary encryption, but TPM-based architectures and post-quantum cryptography \cite{pqcrypto2022} remain underexplored.  

% =============================================================
\section{System Architecture}
The SkyEdge system architecture is shown in Fig.~\ref{fig:sysarch}. The design integrates three stacked layers of control with a secure hardware foundation and variable-pitch mechanical subsystem.  

\subsection{$H_\infty$ Control Layer}
The inner loop is implemented using an $H_\infty$ controller that stabilizes attitude within 1 ms. As shown in Fig.~\ref{fig:step}, step response analysis demonstrates that compared to PID, the $H_\infty$ controller achieves faster settling and significantly reduced overshoot under sudden gusts.  

\subsection{Supervisory FSM Layer}
Above the inner loop, a finite state machine governs operational modes. The FSM supervises transitions between \emph{Normal}, \emph{High-altitude}, \emph{Comm-loss}, and \emph{Emergency return} modes. This ensures safe reconfiguration during GPS loss or link jamming.  

\subsection{LLM-assisted Reconfiguration}
The third layer uses an LLM for off-line adaptive reconfiguration. Flight data are analyzed to retune controller gains or update fault-handling logic. Although not real-time, this accelerates iteration between campaigns.  

\subsection{Performance Illustration}
Figure~\ref{fig:weights} illustrates frequency-domain shaping. The controller maintains low sensitivity $|S|$ at low frequencies for gust rejection, and low complementary sensitivity $|T|$ at high frequencies for noise roll-off. 

% ===================== Fig.1 (TWO columns) =====================
\begin{figure*}[t]
\centering
\resizebox{\textwidth}{!}{%
\begin{tikzpicture}[
    font=\footnotesize,
    node distance=8mm and 12mm,
    box/.style={draw, rounded corners, align=center, inner sep=4pt, minimum width=2.6cm, minimum height=7mm},
    hw/.style={box, fill=gray!10},
    sw/.style={box, fill=blue!6},
    mech/.style={box, fill=green!8},
    sec/.style={box, fill=orange!10, dashed},
    arrow/.style={-Latex, thick},
    grp/.style={draw, rounded corners, inner sep=6pt}
]

% ===== Sensors =====
\node[hw] (imu) {IMU\\(1 kHz)};
\node[hw, right=18mm of imu] (gps) {GNSS\\(ZED-F9P)};
\node[hw, right=18mm of gps] (env) {Env.\\Sensors};

% ===== H-infty control (inner loop) =====
\node[sw, below=10mm of gps, minimum width=12.5cm] (hinf) {$H_\infty$ Controller\\
Disturbance rejection, rate $\leq$ 1.0 ms};

% ===== FSM / LLM =====
\node[sw, below=8mm of hinf, minimum width=12.5cm] (fsm) {FSM Supervisor: Normal / High-alt / Comm-loss / Emergency Return};
\node[sw, below=8mm of fsm, minimum width=12.5cm] (llm) {LLM-assisted Planning \& Auto-tuning (simulation, policy redesign)};

% ===== Hardware stack (row) =====
\node[hw, below left=12mm and -6mm of hinf] (soc) {SoC\\(65 nm FDSOI)};
\node[hw, right=22mm of soc] (esc) {ESC Drivers\\$\leq 100\,\mu$s};
\node[mech, right=22mm of esc] (vp) {Variable-pitch\\20 in Rotor};

% ===== Mechanics / Security / Comms =====
\node[mech, below=10mm of vp] (frame) {CFRP Frame\\700--900 mm};
\node[sec, below=10mm of soc, minimum width=5.2cm] (secblk) {TPM + PQC\\Secure Boot / Keys};
\node[hw, below=8mm of secblk, minimum width=5.2cm] (comms) {Comms (FHSS/UHF, LTE/5G)};

% ===== Group boxes =====
\node[grp, fit=(imu)(gps)(env), label=above:{\strut Sensors}] (gSensors) {};
\node[grp, fit=(hinf)(fsm)(llm), label=right:{\strut Control Stack}] (gCtrl) {};
\node[grp, fit=(soc)(esc)(vp)(frame)(secblk)(comms),
      label=right:{\strut Device / Mechanics / Security}] (gHW) {};

% ===== Connections =====
\draw[arrow] (imu.south) |- (hinf.west);
\draw[arrow] (gps.south) -- (hinf.north);
\draw[arrow] (env.south) |- (fsm.east);

\draw[arrow] (hinf.south) -- (fsm.north);
\draw[arrow] (fsm.south) -- (llm.north);

\draw[arrow] (hinf.south west) |- (soc.north);
\draw[arrow] (soc.east) -- (esc.west);
\draw[arrow] (esc.east) -- (vp.west);
\draw[arrow] (vp.south) -- (frame.north);

\draw[arrow] (fsm.east) -| (secblk.north);
\draw[arrow] (secblk.south) -- (comms.north);

% Feedback
\draw[arrow] (frame.west) -| ++(-12mm,0) |- (imu.south);
\draw[arrow] (vp.north) |- (imu.east);

% ===== Legend (centered, no overlap) =====
\path (gHW.south) ++(0,-6mm) coordinate (leg);
\node[box, fill=blue!6,  anchor=north east] (lg1) at ($(leg)+(-28mm,0)$) {\strut Software};
\node[box, fill=gray!10, anchor=north]      (lg2) at (leg)               {\strut Hardware};
\node[box, fill=green!8, anchor=north west] (lg3) at ($(leg)+(28mm,0)$)   {\strut Mechanics};
\node[box, fill=orange!10, dashed, anchor=north west] (lg4)
      at ($(lg3.north east)+(6mm,0)$) {\strut Security};

\end{tikzpicture}%
}
\caption{SkyEdge system architecture (two-column figure). The three-layer control stack ($H_\infty$, FSM, LLM) integrates with sensors, a secure device stack (SoC, TPM/PQC, comms), and variable-pitch mechanical design.}
\label{fig:sysarch}
\end{figure*}

% ===================== Fig.2 (ONE column) =====================
\begin{figure}[t]
\centering
\begin{tikzpicture}
\begin{axis}[
    width=\columnwidth, height=0.55\columnwidth,
    xmin=0, xmax=5, ymin=-0.1, ymax=2.2,
    xlabel={Time $t$ [s]}, ylabel={Angle [deg]},
    grid=both,
    legend style={at={(0.02,0.98)},anchor=north west,draw=none,fill=none},
    legend cell align={left},
    ytick distance=0.5, xtick distance=0.5
]
% reference
\addplot[dashed] coordinates {(0,1) (5,1)};
\addlegendentry{Reference (1 deg)}

% PID（※ 角括弧あり！）
\addplot[smooth,domain=0:5,samples=200] {1 - exp(-4*x)*(1 + 4*x)};
\addlegendentry{PID}

% H-infinity response with gust at t=2 s
\addplot[very thick] coordinates
{(0,0) (0.5,0.7) (1,0.95) (2,1.0) (2.01,1.25) (2.3,1.05) (3,1.0) (5,1.0)};
\addlegendentry{$H_\infty$}

% gust marker
\draw[dotted] (axis cs:2,-0.1) -- (axis cs:2,2.2);
\end{axis}
\end{tikzpicture}
\caption{Step tracking with a sudden gust. The $H_\infty$ controller yields smaller overshoot and faster recovery than PID when a $+15\%$ gust hits at $t=2$ s.}
\label{fig:step}
\end{figure}

% ===================== Fig.3 (ONE column) =====================
\begin{figure}[t]
\centering
\begin{tikzpicture}
\begin{axis}[
    width=\columnwidth, height=0.55\columnwidth,
    xmin=0, xmax=10, ymin=0, ymax=3,
    xlabel={Altitude [km]}, ylabel={Thrust / Hover [-]},
    grid=both, legend style={at={(0.02,0.98)},anchor=north west,draw=none,fill=none},
    legend cell align={left}
]
\addplot[smooth,domain=0:10,samples=200] {2.2 - 0.18*x};      % variable pitch (scheduled)
\addlegendentry{Variable pitch (scheduled)}
\addplot[smooth,domain=0:10,samples=200] {2.2 - 0.28*x};      % fixed pitch
\addlegendentry{Fixed pitch}
\addplot[dashed] coordinates {(0,1) (10,1)};                   % hover threshold
\addlegendentry{Hover threshold}
\end{axis}
\end{tikzpicture}
\caption{Thrust margin vs. altitude. Pitch scheduling maintains margin above $1$ up to 10 km, while a fixed-pitch rotor loses margin.}
\label{fig:margin}
\end{figure}

% ===================== Fig.4 (ONE column) =====================
\begin{figure}[t]
\centering
\begin{tikzpicture}
\begin{axis}[
    width=\columnwidth, height=0.55\columnwidth,
    xmin=0, xmax=20, ymin=0, ymax=1.5,
    xlabel={Pitch angle [\si{\degree}]}, ylabel={Required servo torque [N\,m]},
    grid=both, legend style={at={(0.02,0.98)},anchor=north west,draw=none,fill=none},
    legend cell align={left}
]
\addplot[smooth,domain=0:20,samples=200] {0.02 + 0.03*x + 0.0015*x*x};
\addlegendentry{Required torque (model)}
\addplot[dashed] coordinates {(0,0.62) (20,0.62)};
\addlegendentry{Design point}
\addplot[dotted] coordinates {(0,1.24) (20,1.24)};
\addlegendentry{Safety band ($\times 2$)}
\end{axis}
\end{tikzpicture}
\caption{Servo torque vs. pitch angle for the variable-pitch mechanism. The design point \SI{0.62}{N\,m} leaves a safety margin of $\times 2$.}
\label{fig:torque}
\end{figure}

% ===================== Fig.5 (ONE column) =====================
\begin{figure}[t]
\centering
\begin{tikzpicture}
\begin{semilogxaxis}[
    width=\columnwidth, height=0.6\columnwidth,
    xmin=1e-1, xmax=1e3, ymin=-60, ymax=10,
    xlabel={Frequency [rad/s]}, ylabel={Magnitude [dB]},
    grid=both, legend style={at={(0.02,0.98)},anchor=north west,draw=none,fill=none},
    legend cell align={left}
]
% Target |S| and |T|
\addplot[very thick] coordinates {(0.1,-20) (1,-20) (10,-10) (100,-40) (1000,-60)};
\addlegendentry{$|S(j\omega)|$ (target)}
\addplot[dashed, very thick] coordinates {(0.1,0) (1,0) (10,0) (100,-20) (1000,-40)};
\addlegendentry{$|T(j\omega)|$ (target)}
% Weight hints
\addplot[densely dotted] coordinates {(0.1,-40) (1,-20) (10,0) (100,0) (1000,0)};
\addlegendentry{$1/|W_1|$ (disturbance rejection)}
\addplot[dotted] coordinates {(0.1,0) (1,0) (10,-20) (100,-40) (1000,-60)};
\addlegendentry{$1/|W_3|$ (roll-off)}
\end{semilogxaxis}
\end{tikzpicture}
\caption{Frequency-domain intuition for $H_\infty$ design: low $|S|$ at low--mid frequency (disturbance rejection) and low $|T|$ at high frequency (noise/roll-off).}
\label{fig:weights}
\end{figure}

% -------------------------------------------------------------
\section{Device Integration}
The device stack emphasizes domestic sourcing. A 65 nm FDSOI SoC runs the control stack with real-time determinism. LDMOS-based ESC drivers achieve sub-\SI{100}{\micro\second} latency, ensuring cycle closure within 1 ms.  

Sensors include a 1 kHz IMU, ZED-F9P GNSS, and environmental probes for air pressure and temperature. These enable both control stabilization and high-altitude compensation.  

Security is ensured with TPM 2.0 modules and PQC (Kyber KEM) for key exchange. Secure boot prevents unauthorized firmware injection, and telemetry links are encrypted. Communication redundancy combines FHSS/UHF links with LTE/5G.  

Estimated BOM per prototype is \SI{596700}{JPY}, with cost reductions expected in mass production.  

% =============================================================
\section{Mechanical Design}
The UAV frame is a CFRP structure spanning 700--900 mm. The total take-off mass is 6.38 kg.  

\subsection{Thrust Margin Across Altitude}
The thrust-to-weight ratio is $\approx 2.82$ at sea level. As shown in Fig.~\ref{fig:margin}, thrust margin diminishes with altitude for fixed-pitch rotors. A scheduled variable-pitch mechanism maintains margin above 1.0 up to 10 km.  

\subsection{Pitch Actuation}
Servo torque is modeled as in Fig.~\ref{fig:torque}. The required torque for full pitch deflection is 0.62 N·m, with a built-in safety margin of $\times 2$--3. This ensures reliability under icing or unexpected aerodynamic loads.  

% =============================================================
\section{Evaluation Plan}
To validate SkyEdge, we define a staged evaluation program:  

\textbf{(1) Wind-tunnel testing:} Validate disturbance rejection under gusts up to 30 m/s.  
\textbf{(2) Environmental testing:} Thermal cycling in a low-temperature chamber from –40 °C to +60 °C.  
\textbf{(3) Communication robustness:} Assess FHSS resilience under jamming scenarios.  
\textbf{(4) Redundancy:} Verify dual ESC and sensor fusion cross-check.  

The prototype roadmap spans 2025–2026. Flight campaigns will culminate in outdoor high-altitude trials by late 2026.  

% =============================================================
\section{Conclusion}
We have presented the design of SkyEdge, a secure UAV platform for high-altitude operations. By combining $H_\infty$ control, domestic device integration, and variable-pitch rotor design, the platform addresses robustness, security, and adaptability. Future work will extend to swarm coordination and underwater adaptation (\emph{SeaEdge}), creating a unified autonomous system for defense, disaster response, and environmental applications.  

% ---------- References ----------
\bibliographystyle{IEEEtran}
\begin{thebibliography}{99}
\bibitem{zhou1996robust} K. Zhou, J. C. Doyle, and K. Glover, \emph{Robust and Optimal Control}. Prentice Hall, 1996.
\bibitem{nasahelios} NASA, ``Helios Prototype UAV,'' NASA Facts, 2003.
\bibitem{jaxaHAPS} JAXA, ``High Altitude Platform Station (HAPS) Research,'' 2020.
\bibitem{dji2022} DJI, ``Matrice 300 RTK Specifications,'' DJI, 2022.
\bibitem{pqcrypto2022} NIST, ``Post-Quantum Cryptography Standardization,'' 2022.
\end{thebibliography}

\end{document}
